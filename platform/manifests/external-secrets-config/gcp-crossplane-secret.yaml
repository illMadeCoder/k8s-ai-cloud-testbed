# ExternalSecret for GCP Crossplane Provider
#
# Syncs GCP service account JSON key from OpenBao to crossplane-system.
# The secret format matches what provider-gcp expects for Secret auth.

apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: gcp-crossplane-credentials
  namespace: crossplane-system
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: openbao
  target:
    name: gcp-credentials
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        # GCP provider expects the full JSON service account key
        credentials: "{{ .credentials }}"
  data:
    - secretKey: credentials
      remoteRef:
        key: cloud/gcp
        property: credentials
