# Logging Stack Comparison Dashboard
# Side-by-side resource comparison: Loki vs Elasticsearch

apiVersion: v1
kind: ConfigMap
metadata:
  name: logging-comparison-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    experiment: logging-comparison
data:
  logging-comparison.json: |
    {
      "annotations": {
        "list": []
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "id": null,
      "links": [],
      "liveNow": false,
      "panels": [
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
          "id": 100,
          "panels": [],
          "title": "Memory Usage",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 1 },
          "id": 1,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(container_memory_working_set_bytes{namespace=\"loki\", container!=\"\"}) by (pod)",
              "legendFormat": "{{pod}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Loki Stack Memory",
          "type": "timeseries"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 1 },
          "id": 2,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(container_memory_working_set_bytes{namespace=\"elasticsearch\", container!=\"\"}) by (pod)",
              "legendFormat": "{{pod}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Elasticsearch Stack Memory",
          "type": "timeseries"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 9 },
          "id": 101,
          "panels": [],
          "title": "CPU Usage",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 10 },
          "id": 3,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"loki\", container!=\"\"}[5m])) by (pod)",
              "legendFormat": "{{pod}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Loki Stack CPU",
          "type": "timeseries"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": false,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 10 },
          "id": 4,
          "options": {
            "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"elasticsearch\", container!=\"\"}[5m])) by (pod)",
              "legendFormat": "{{pod}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Elasticsearch Stack CPU",
          "type": "timeseries"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 18 },
          "id": 102,
          "panels": [],
          "title": "Total Resource Comparison",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 500000000 }, { "color": "red", "value": 1000000000 }] },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 6, "w": 6, "x": 0, "y": 19 },
          "id": 5,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(container_memory_working_set_bytes{namespace=\"loki\", container!=\"\"})",
              "legendFormat": "Loki Total Memory",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Loki Total Memory",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 500000000 }, { "color": "red", "value": 1000000000 }] },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": { "h": 6, "w": 6, "x": 6, "y": 19 },
          "id": 6,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(container_memory_working_set_bytes{namespace=\"elasticsearch\", container!=\"\"})",
              "legendFormat": "Elasticsearch Total Memory",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Elasticsearch Total Memory",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "red", "value": 1 }] },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 6, "w": 6, "x": 12, "y": 19 },
          "id": 7,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"loki\", container!=\"\"}[5m]))",
              "legendFormat": "Loki Total CPU",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Loki Total CPU",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "red", "value": 1 }] },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 6, "w": 6, "x": 18, "y": 19 },
          "id": 8,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=\"elasticsearch\", container!=\"\"}[5m]))",
              "legendFormat": "Elasticsearch Total CPU",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Elasticsearch Total CPU",
          "type": "stat"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 25 },
          "id": 103,
          "panels": [],
          "title": "Log Generator Status",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 8, "x": 0, "y": 26 },
          "id": 9,
          "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "log_generator_logs_generated_total",
              "legendFormat": "Total Logs",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Total Logs Generated",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "ops"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 8, "x": 8, "y": 26 },
          "id": 10,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "rate(log_generator_logs_generated_total[1m])",
              "legendFormat": "Logs/sec",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Log Generation Rate",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 8, "x": 16, "y": 26 },
          "id": 11,
          "options": {
            "colorMode": "value",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
            "textMode": "auto"
          },
          "targets": [
            {
              "datasource": { "type": "prometheus", "uid": "prometheus" },
              "editorMode": "code",
              "expr": "log_generator_active_services",
              "legendFormat": "Services",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Active Services (Cardinality)",
          "type": "stat"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 30 },
          "id": 104,
          "panels": [],
          "title": "Architecture Overview",
          "type": "row"
        },
        {
          "datasource": { "type": "datasource", "uid": "-- Dashboard --" },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 31 },
          "id": 12,
          "options": {
            "code": { "language": "plaintext", "showLineNumbers": false, "showMiniMap": false },
            "content": "## Loki Architecture\n\n```\nPods → stdout → Promtail → Loki\n                  │           │\n            Parse JSON    Store by labels\n            Add labels    (chunks on disk)\n```\n\n**Key characteristics:**\n- Label-indexed (namespace, pod, level)\n- Stores log chunks, not individual lines\n- Queries grep through chunks\n- Low memory footprint\n- Best for: Label-based filtering",
            "mode": "markdown"
          },
          "title": "Loki: Label-Indexed Storage",
          "type": "text"
        },
        {
          "datasource": { "type": "datasource", "uid": "-- Dashboard --" },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 31 },
          "id": 13,
          "options": {
            "code": { "language": "plaintext", "showLineNumbers": false, "showMiniMap": false },
            "content": "## Elasticsearch Architecture\n\n```\nPods → stdout → Fluent Bit → Elasticsearch\n                    │              │\n              Parse JSON     Inverted index\n              Add metadata   (all fields)\n```\n\n**Key characteristics:**\n- Full-text inverted index on ALL fields\n- Each field is searchable\n- Higher memory for indexing\n- Higher storage for indices\n- Best for: Full-text search, complex queries",
            "mode": "markdown"
          },
          "title": "Elasticsearch: Full-Text Indexing",
          "type": "text"
        }
      ],
      "refresh": "10s",
      "schemaVersion": 38,
      "style": "dark",
      "tags": ["logging", "comparison", "loki", "elasticsearch"],
      "templating": { "list": [] },
      "time": { "from": "now-30m", "to": "now" },
      "timepicker": {},
      "timezone": "",
      "title": "Logging Stack Comparison",
      "uid": "logging-comparison",
      "version": 1,
      "weekStart": ""
    }
