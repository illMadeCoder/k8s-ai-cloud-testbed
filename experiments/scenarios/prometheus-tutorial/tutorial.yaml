# Tutorial configuration
# When this file exists, `task kind:conduct` runs in interactive mode

title: "Prometheus & Grafana Tutorial"
description: |
  Learn Prometheus metrics collection, PromQL queries, and Grafana dashboards.

instructions: |
  ## Getting Started

  1. Open Prometheus UI in your browser (URL shown above)
  2. Open Grafana UI in your browser (URL shown above)
     - Login with: admin / admin

  ## Try These PromQL Queries

  In Prometheus UI, go to Graph tab and try:

  ### Request Rate
  ```
  rate(http_requests_total[1m])
  ```

  ### Error Rate
  ```
  sum(rate(http_requests_total{status=~"5.."}[1m])) / sum(rate(http_requests_total[1m]))
  ```

  ### 95th Percentile Latency
  ```
  histogram_quantile(0.95, rate(request_duration_seconds_bucket[1m]))
  ```

  ### Latency by Endpoint
  ```
  histogram_quantile(0.95, sum(rate(request_duration_seconds_bucket[1m])) by (path, le))
  ```

  ## Generate Load

  The metrics-app IP is shown above. Generate traffic with:
  ```bash
  # Replace METRICS_IP with the metrics-app IP shown above
  METRICS_IP=<metrics-app-ip>
  for i in {1..50}; do
    curl -s http://$METRICS_IP/
    curl -s http://$METRICS_IP/slow
    curl -s http://$METRICS_IP/error
    curl -s http://$METRICS_IP/process
    sleep 0.3
  done
  ```

  ## Explore Grafana Dashboards

  1. Go to Dashboards in the left menu
  2. Browse pre-built dashboards:
     - Kubernetes / Compute Resources / Cluster
     - Kubernetes / Compute Resources / Namespace (Pods)
     - Node Exporter / Nodes

  ## When You're Done

  Press ENTER to tear down the experiment.
