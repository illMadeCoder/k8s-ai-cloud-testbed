apiVersion: experiments.illm.io/v1alpha1
kind: Experiment
metadata:
  generateName: gateway-comparison-
  namespace: experiments
spec:
  description: "Gateway comparison - NGINX Ingress vs Traefik vs Envoy Gateway feature and performance analysis"
  tags: ["comparison", "networking", "gateway"]
  publish: true
  ttlDays: 7

  study:
    hypothesis: "Envoy Gateway will have the richest feature set because it implements Gateway API natively with Envoy's extensible filter chain architecture, but this comes at higher base resource usage because it runs a separate control plane and data plane process, while NGINX Ingress will be the most resource-efficient for simple routing because its single-process model avoids the overhead of a dedicated control plane"
    questions:
      - "What is the idle and loaded CPU/memory footprint of each gateway controller?"
      - "Which gateways support Gateway API natively vs. requiring translation layers?"
      - "How do configuration models compare (Ingress vs. Gateway API vs. custom CRDs)?"
    focus:
      - "resource efficiency"
      - "Gateway API conformance"
      - "configuration complexity"
      - "feature breadth"

  targets:
    - name: app
      cluster:
        type: gke
        machineType: e2-standard-4
        preemptible: true
      observability:
        enabled: true
        transport: tailscale
      components:
        - app: nginx-ingress
        - app: traefik
        - app: envoy-gateway
        - app: nginx
          params:
            replicaCount: "2"

  workflow:
    template: gateway-comparison-validation
    completion:
      mode: workflow
