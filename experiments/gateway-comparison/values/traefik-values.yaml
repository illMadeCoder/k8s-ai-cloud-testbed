# Traefik Helm values for Gateway Comparison
# Enables both Ingress and Gateway API support

# Gateway API support
providers:
  kubernetesIngress:
    enabled: true
    ingressClass: traefik
  kubernetesGateway:
    enabled: true

# Gateway API provider (no longer experimental in v3.1+)
# Remove experimental.kubernetesGateway, use providers.kubernetesGateway instead

# GatewayClass configuration
# Disabled - we create GatewayClass in manifests/traefik-routes.yaml
gatewayClass:
  enabled: false

# Service configuration
service:
  type: LoadBalancer
  annotations:
    metallb.universe.tf/allow-shared-ip: "gateway-comparison"

# Port configuration
# Keep default internal ports, expose on standard ports
ports:
  web:
    port: 8000
    expose:
      default: true
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 8443
    expose:
      default: true
    exposedPort: 443
    protocol: TCP
  # Traefik default entrypoint uses 9000, use different port for gRPC
  grpc:
    port: 9001
    expose:
      default: true
    exposedPort: 9000
    protocol: TCP

# Enable metrics for comparison
metrics:
  prometheus:
    enabled: true
    entryPoint: metrics
    addEntryPointsLabels: true
    addServicesLabels: true
    addRoutersLabels: true

# Resource limits appropriate for Kind
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 256Mi

# Access logs for debugging
logs:
  general:
    level: INFO
  access:
    enabled: true
    format: json

# IngressClass settings
ingressClass:
  enabled: true
  isDefaultClass: false  # nginx is default for this comparison

# Deployment configuration
deployment:
  replicas: 1

# NOTE: Traefik's Gateway API support is experimental.
# The Gateway in gateway-comparison namespace may require
# additional RBAC configuration for cross-namespace access.
