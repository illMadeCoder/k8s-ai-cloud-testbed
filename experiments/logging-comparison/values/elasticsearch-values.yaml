# Elasticsearch - Helm values for logging comparison tutorial
# Uses elastic/elasticsearch chart 8.5.1
# https://github.com/elastic/helm-charts/tree/main/elasticsearch
#
# IMPORTANT: Security is disabled for tutorial simplicity.
# Do NOT use this configuration in production.

# Single node mode
replicas: 1
minimumMasterNodes: 1

# Cluster name
clusterName: "logging-comparison"

# Resources - minimum viable for Kind
resources:
  requests:
    cpu: 500m
    memory: 1Gi
  limits:
    cpu: 1000m
    memory: 2Gi

# JVM heap - half of memory limit
esJavaOpts: "-Xmx1g -Xms1g"

# Disable TLS certificate generation (security disabled)
createCert: false

# Keep credential secret for readiness probe compatibility
# The probe script requires ELASTIC_PASSWORD env var even when security is disabled
secret:
  enabled: true
  password: "admin"

# Disable helm tests (they expect TLS)
tests:
  enabled: false

# Configure Elasticsearch via elasticsearch.yml
# Note: discovery.type must be set via env var (extraEnvs) not esConfig
# because the chart also sets cluster.initial_master_nodes which conflicts
esConfig:
  elasticsearch.yml: |
    cluster.name: logging-comparison
    network.host: 0.0.0.0
    xpack.security.enabled: false
    xpack.security.enrollment.enabled: false
    xpack.security.http.ssl.enabled: false
    xpack.security.transport.ssl.enabled: false

# Single-node discovery via env var (overrides chart's cluster.initial_master_nodes)
extraEnvs:
  - name: discovery.type
    value: single-node
  - name: cluster.initial_master_nodes
    value: ""

# Ephemeral storage (no persistence for tutorial)
persistence:
  enabled: false

# Soft anti-affinity (allows single-node Kind)
antiAffinity: "soft"

# Protocol for readiness probe
protocol: http
