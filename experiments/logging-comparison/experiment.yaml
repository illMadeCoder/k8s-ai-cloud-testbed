apiVersion: experiments.illm.io/v1alpha1
kind: Experiment
metadata:
  generateName: logging-comparison-
  namespace: experiments
spec:
  description: "Loki vs Elasticsearch logging comparison - architecture, resource usage, query performance"
  tags: ["comparison", "observability", "logging"]
  publish: true
  ttlDays: 7

  analysis:
    sections:
      - abstract
      - targetAnalysis
      - performanceAnalysis
      - metricInsights
      - finopsAnalysis
      - secopsAnalysis
      - body
      - capabilitiesMatrix
      - feedback
      - architectureDiagram

  study:
    hypothesis: "Loki will use significantly fewer resources than Elasticsearch for equivalent log ingestion volume because it indexes only labels rather than full log content, but Elasticsearch will offer richer full-text query capabilities because its inverted index enables arbitrary field searches that LogQL's label-based filtering cannot match"
    questions:
      - "What is the CPU and memory overhead difference between Loki and Elasticsearch at steady-state log ingestion?"
      - "How do LogQL and Lucene/KQL compare for common operational log queries?"
      - "Which stack is more cost-effective for a small-to-medium Kubernetes cluster?"
    focus:
      - "resource efficiency"
      - "query capability"
      - "storage architecture"
      - "operational complexity"

  targets:
    - name: app
      cluster:
        type: gke
        machineType: e2-standard-4
        preemptible: true
      observability:
        enabled: true
        transport: tailscale
      components:
        - app: loki
        - app: promtail
        - app: elasticsearch
        - app: fluent-bit
        - app: log-generator

  workflow:
    template: logging-comparison-validation
    completion:
      mode: workflow
