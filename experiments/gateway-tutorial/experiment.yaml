apiVersion: experiments.illm.io/v1alpha1
kind: Experiment
metadata:
  generateName: gateway-tutorial-
  namespace: experiments
spec:
  description: "Gateway API tutorial - Ingress basics to Gateway API migration with Envoy"
  tags: ["tutorial", "networking", "gateway"]
  ttlDays: 7

  targets:
    - name: app
      cluster:
        type: gke
        preemptible: true
      components:
        - app: nginx-ingress
        - app: envoy-gateway
        - app: nginx
          params:
            replicaCount: "2"

  workflow:
    template: gateway-validation
    completion:
      mode: manual

  tutorial:
    exposeKubeconfig: true
    services:
      - name: nginx-ingress
        target: app
        service: ingress-nginx-controller
        namespace: gateway-tutorial
      - name: envoy-gateway
        target: app
        service: envoy-gateway
        namespace: gateway-tutorial
