---
# Azure ProviderConfig with Workload Identity
# This configuration uses Azure Workload Identity for authentication
# No secrets required - credentials are obtained via OIDC federation
#
# Prerequisites:
# 1. AKS cluster must have Workload Identity enabled
# 2. User-Assigned Managed Identity must be created with federated credential
# 3. Managed Identity must have appropriate Azure RBAC roles
#
# The CLIENT_ID below should be replaced with the actual managed identity client ID
# from the Terraform AKS module output: module.aks.crossplane_identity_client_id
apiVersion: azure.upbound.io/v1beta1
kind: ProviderConfig
metadata:
  name: default
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  credentials:
    source: InjectedIdentity
  # Subscription ID is required
  subscriptionID: "" # Set via Kustomize overlay or environment-specific config
  tenantID: ""       # Set via Kustomize overlay or environment-specific config
---
# Alternative ProviderConfig for development/testing with Secret
# Uncomment and use this when Workload Identity is not available (e.g., minikube)
# apiVersion: azure.upbound.io/v1beta1
# kind: ProviderConfig
# metadata:
#   name: azure-secret
# spec:
#   credentials:
#     source: Secret
#     secretRef:
#       namespace: crossplane-system
#       name: azure-credentials
#       key: credentials
