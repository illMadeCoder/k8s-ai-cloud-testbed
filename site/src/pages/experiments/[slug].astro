---
import Base from '../../layouts/Base.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import ExperimentDetail from '../../components/ExperimentDetail.astro';
import { loadAllExperiments, groupExperiments, formatDisplayName } from '../../lib/experiments';
import type { ExperimentGroup } from '../../lib/experiments';

export function getStaticPaths() {
  const experiments = loadAllExperiments();
  const groups = groupExperiments(experiments);
  return groups.map((group) => ({
    params: { slug: group.baseName },
    props: { group },
  }));
}

interface Props {
  group: ExperimentGroup;
}

const { group } = Astro.props;
const base = import.meta.env.BASE_URL;
const displayName = formatDisplayName(group.baseName);
---

<Base title={`${displayName} â€” K8s AI Lab Benchmarks`} description={group.latest.description}>
  <Breadcrumb
    crumbs={[
      { label: 'Home', href: base },
      { label: 'Experiments', href: base },
      { label: displayName },
    ]}
    slot="breadcrumb"
  />
  <ExperimentDetail
    experiment={group.latest}
    displayName={displayName}
    tags={group.tags}
    runHistory={{ baseName: group.baseName, runs: group.runs }}
  />
</Base>
