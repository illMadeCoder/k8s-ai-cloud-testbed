---
import Base from '../../layouts/Base.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import { loadAllExperiments, groupByProject } from '../../lib/experiments';
import { loadProjects } from '../../lib/projects';

const experiments = loadAllExperiments();
const projectGroups = groupByProject(experiments);
const projects = loadProjects();
const base = import.meta.env.BASE_URL;
---

<Base title="Projects â€” K8s Cloud TestBed">
  <Breadcrumb
    crumbs={[
      { label: 'Home', href: base },
      { label: 'Projects' },
    ]}
    slot="breadcrumb"
  />

  <h1 class="text-2xl font-bold mb-2">Ongoing Projects</h1>
  <p class="text-text-muted mb-8 max-w-2xl">
    Long-term research tracks grouping related experiments around a common theme.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    {projects.map((p) => (
      <ProjectCard
        id={p.id}
        name={p.name}
        description={p.description}
        experimentCount={(projectGroups[p.id] ?? []).length}
      />
    ))}
  </div>
</Base>
