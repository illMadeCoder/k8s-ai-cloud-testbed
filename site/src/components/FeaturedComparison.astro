---
import type { ExperimentGroup } from '../lib/experiments';
import { formatDisplayName } from '../lib/experiments';
import { formatDate } from '../lib/format';

interface Props {
  group: ExperimentGroup;
}

const { group } = Astro.props;
const { latest } = group;
const base = import.meta.env.BASE_URL;

const contenders = latest.targets.map((t) =>
  t.components?.join(', ') || t.name
);
---

<a href={`${base}experiments/${group.baseName}/`} class="block bg-bg-card border border-border rounded p-5 shadow hover:shadow-lg transition-shadow no-underline group">
  <div class="flex items-center justify-between mb-2">
    <span class="text-xs font-semibold uppercase tracking-wider text-accent">Comparison</span>
    <span class="text-xs text-text-muted">{formatDate(latest.createdAt)}</span>
  </div>
  <h3 class="text-base font-semibold font-mono text-text group-hover:text-accent transition-colors mb-2">
    {formatDisplayName(group.baseName)}
  </h3>
  <p class="text-sm text-text-muted mb-3 line-clamp-2">{latest.description}</p>
  {contenders.length > 0 && (
    <div class="flex flex-wrap gap-1.5">
      {contenders.map((c) => (
        <span class="text-xs px-2 py-0.5 rounded-full bg-bg-surface text-text-muted border border-border font-mono">{c}</span>
      ))}
    </div>
  )}
</a>
