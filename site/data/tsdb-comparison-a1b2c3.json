{
  "name": "tsdb-comparison-a1b2c3",
  "namespace": "experiments",
  "description": "TSDB comparison - Prometheus vs VictoriaMetrics resource efficiency and query performance",
  "createdAt": "2026-02-01T10:00:00Z",
  "completedAt": "2026-02-01T11:30:00Z",
  "durationSeconds": 5400,
  "phase": "Complete",
  "tags": ["observability", "comparison", "metrics"],
  "targets": [
    {
      "name": "app",
      "clusterName": "tsdb-comparison-a1b2c3-app",
      "clusterType": "gke",
      "machineType": "e2-standard-4",
      "nodeCount": 3,
      "components": [
        "kube-prometheus-stack",
        "victoria-metrics",
        "mimir",
        "minio",
        "cardinality-generator"
      ]
    }
  ],
  "workflow": {
    "name": "tsdb-comparison-a1b2c3-validation",
    "template": "tsdb-comparison-validation",
    "phase": "Succeeded",
    "startedAt": "2026-02-01T10:05:00Z",
    "finishedAt": "2026-02-01T11:28:00Z"
  },
  "metrics": {
    "collectedAt": "2026-02-01T11:29:00Z",
    "timeRange": {
      "start": "2026-02-01T10:00:00Z",
      "end": "2026-02-01T11:30:00Z",
      "duration": "1h30m0s",
      "stepSeconds": 60
    },
    "queries": {
      "memory_peak": {
        "query": "max_over_time(container_memory_working_set_bytes{experiment=\"tsdb-comparison-a1b2c3\"}[1h30m])",
        "type": "instant",
        "unit": "bytes",
        "description": "Peak memory usage per TSDB",
        "data": [
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:30:00Z", "value": 1073741824 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:30:00Z", "value": 419430400 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:30:00Z", "value": 838860800 }
        ]
      },
      "cpu_avg": {
        "query": "avg_over_time(rate(container_cpu_usage_seconds_total{experiment=\"tsdb-comparison-a1b2c3\"}[5m])[1h30m:])",
        "type": "instant",
        "unit": "cores",
        "description": "Average CPU usage per TSDB",
        "data": [
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.85 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.32 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.71 }
        ]
      },
      "ingestion_rate": {
        "query": "rate(prometheus_tsdb_head_samples_appended_total{experiment=\"tsdb-comparison-a1b2c3\"}[5m])",
        "type": "range",
        "unit": "samples/s",
        "description": "Sample ingestion rate over time",
        "data": [
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:10:00Z", "value": 12500 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:20:00Z", "value": 13200 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:30:00Z", "value": 13800 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:40:00Z", "value": 14100 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:50:00Z", "value": 14300 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:00:00Z", "value": 14200 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:10:00Z", "value": 14400 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:20:00Z", "value": 14100 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:30:00Z", "value": 14000 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:10:00Z", "value": 12500 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:20:00Z", "value": 14800 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:30:00Z", "value": 16200 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:40:00Z", "value": 17500 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:50:00Z", "value": 18100 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:00:00Z", "value": 18400 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:10:00Z", "value": 18600 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:20:00Z", "value": 18500 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:30:00Z", "value": 18300 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:10:00Z", "value": 12500 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:20:00Z", "value": 13600 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:30:00Z", "value": 14800 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:40:00Z", "value": 15400 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:50:00Z", "value": 15800 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:00:00Z", "value": 16000 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:10:00Z", "value": 16200 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:20:00Z", "value": 16100 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:30:00Z", "value": 15900 }
        ]
      },
      "query_latency_p99": {
        "query": "histogram_quantile(0.99, rate(prometheus_engine_query_duration_seconds_bucket{experiment=\"tsdb-comparison-a1b2c3\"}[5m]))",
        "type": "range",
        "unit": "seconds",
        "description": "P99 query latency over time",
        "data": [
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:10:00Z", "value": 0.45 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:20:00Z", "value": 0.52 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:30:00Z", "value": 0.61 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:40:00Z", "value": 0.58 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T10:50:00Z", "value": 0.63 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:00:00Z", "value": 0.67 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:10:00Z", "value": 0.72 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:20:00Z", "value": 0.69 },
          { "labels": { "target": "prometheus" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.71 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:10:00Z", "value": 0.12 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:20:00Z", "value": 0.14 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:30:00Z", "value": 0.13 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:40:00Z", "value": 0.15 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T10:50:00Z", "value": 0.14 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:00:00Z", "value": 0.16 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:10:00Z", "value": 0.15 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:20:00Z", "value": 0.17 },
          { "labels": { "target": "victoria-metrics" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.16 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:10:00Z", "value": 0.31 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:20:00Z", "value": 0.35 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:30:00Z", "value": 0.38 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:40:00Z", "value": 0.36 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T10:50:00Z", "value": 0.39 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:00:00Z", "value": 0.41 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:10:00Z", "value": 0.40 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:20:00Z", "value": 0.42 },
          { "labels": { "target": "mimir" }, "timestamp": "2026-02-01T11:30:00Z", "value": 0.41 }
        ]
      }
    }
  },
  "costEstimate": {
    "totalUSD": 0.60,
    "durationHours": 1.5,
    "perTarget": {
      "app": 0.60
    },
    "note": "Rough estimate based on on-demand GCE pricing (e2-standard-4 x3 nodes, preemptible); actual cost may differ."
  },
  "analysis": {
    "summary": "VictoriaMetrics dominated this comparison, using 61% less memory (400MB vs 1GB) and 62% less CPU (0.32 vs 0.85 cores) than Prometheus while sustaining 30% higher ingestion rates (18.3k vs 14k samples/s). Mimir landed between the two on resource usage but added object storage complexity. Query latency strongly favored VictoriaMetrics at 0.16s P99 compared to 0.71s for Prometheus and 0.41s for Mimir.",
    "metricInsights": {
      "memory_peak": "VictoriaMetrics peaked at 400MB, less than half of Mimir (800MB) and under 40% of Prometheus (1GB). For resource-constrained environments, VictoriaMetrics offers a significantly smaller memory footprint.",
      "cpu_avg": "VictoriaMetrics averaged 0.32 cores, roughly a third of Prometheus (0.85 cores). Mimir's 0.71 cores reflects its distributed architecture overhead even in single-node mode.",
      "ingestion_rate": "VictoriaMetrics ramped up to 18.3k samples/s and stabilized, while Prometheus plateaued around 14k. Mimir reached 16k, showing its horizontal scaling potential even on a single node.",
      "query_latency_p99": "VictoriaMetrics maintained consistently low P99 latency (0.12-0.17s) throughout the test. Prometheus latency degraded from 0.45s to 0.71s as data accumulated, suggesting index pressure under growing cardinality."
    },
    "recommendations": [
      "Consider VictoriaMetrics as the primary TSDB for cost-sensitive deployments â€” it delivers better performance at roughly one-third the resource cost of Prometheus.",
      "If Prometheus ecosystem compatibility is required, evaluate VictoriaMetrics as a remote-write target to get storage efficiency while keeping Prometheus for collection and alerting.",
      "Mimir should be re-tested in a multi-node configuration to evaluate its horizontal scaling benefits, which are not visible in this single-node comparison."
    ],
    "generatedAt": "2026-02-09T12:00:00Z",
    "model": "claude-opus-4-6"
  }
}
